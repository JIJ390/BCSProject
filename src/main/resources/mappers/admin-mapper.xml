<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="edu.kh.bcs.admin.mapper.AdminMapper">

	<select id="memberNoCount">
		SELECT COUNT(*)
		FROM MEMBER
		WHERE MEMBER_NO = #{searchText}
	</select>
	
	<select id="memberNameCount">
		SELECT COUNT(*)
		FROM MEMBER
		WHERE MEMBER_NAME LIKE '%' || #{searchText} || '%'
	</select>
	
	<select id="memberEmailCount">
		SELECT COUNT(*)
		FROM MEMBER
		WHERE MEMBER_EMAIL LIKE '%' || #{searchText} || '%'
	</select>
	
	<select id="memberTelCount">
		SELECT COUNT(*)
		FROM MEMBER
		WHERE MEMBER_TEL LIKE '%' || #{searchText} || '%'
	</select>
	
	<select id="allCount">
		SELECT COUNT(*)
		FROM MEMBER
	</select>
	
	
	
	
	
	<select id="memberNoList" resultType="Member">
		SELECT *
		FROM MEMBER
		WHERE MEMBER_NO = #{searchText}
	</select>
	
	<select id="memberNameListU" resultType="Member">
SELECT E.*
FROM
	(SELECT 
		MEMBER_NO,
		MEMBER_NAME,
		MEMBER_EMAIL,
		MEMBER_PW,
		MEMBER_DEL_FL,
		MEMBER_DATE,
		MEMBER_ADDRESS,
		MEMBER_FL,
		MEMBER_POINT,
		MEMBER_TEL,
		MEMBER_ID,
		ROWNUM "RN"
	FROM "MEMBER"
	WHERE (MEMBER_NAME LIKE '%' || #{searchText} || '%')
	ORDER BY MEMBER_NAME ASC) E
WHERE E.RN BETWEEN 1 + ((#{cp}-1)*10)AND 10 + ((#{cp}-1)*10)
	</select>
	<select id="memberNameListD" resultType="Member">
SELECT E.*
FROM
	(SELECT 
		MEMBER_NO,
		MEMBER_NAME,
		MEMBER_EMAIL,
		MEMBER_PW,
		MEMBER_DEL_FL,
		MEMBER_DATE,
		MEMBER_ADDRESS,
		MEMBER_FL,
		MEMBER_POINT,
		MEMBER_TEL,
		MEMBER_ID,
		ROWNUM "RN"
	FROM "MEMBER"
	WHERE (MEMBER_NAME LIKE '%' || #{searchText} || '%')
	ORDER BY MEMBER_NAME DESC) E
WHERE E.RN BETWEEN 1 + ((#{cp}-1)*10)AND 10 + ((#{cp}-1)*10)
	</select>
	
	<select id="memberEmailListU" resultType="Member">
SELECT E.*
FROM
	(SELECT 
		MEMBER_NO,
		MEMBER_NAME,
		MEMBER_EMAIL,
		MEMBER_PW,
		MEMBER_DEL_FL,
		MEMBER_DATE,
		MEMBER_ADDRESS,
		MEMBER_FL,
		MEMBER_POINT,
		MEMBER_TEL,
		MEMBER_ID,
		ROWNUM "RN"
	FROM "MEMBER"
	WHERE MEMBER_EMAIL LIKE '%' || #{searchText} || '%'
	ORDER BY MEMBER_EMAIL ASC) E
WHERE E.RN BETWEEN 1 + ((#{cp}-1)*10)AND 10 + ((#{cp}-1)*10)
	</select>
	<select id="memberEmailListD" resultType="Member">
SELECT E.*
FROM
	(SELECT 
		MEMBER_NO,
		MEMBER_NAME,
		MEMBER_EMAIL,
		MEMBER_PW,
		MEMBER_DEL_FL,
		MEMBER_DATE,
		MEMBER_ADDRESS,
		MEMBER_FL,
		MEMBER_POINT,
		MEMBER_TEL,
		MEMBER_ID,
		ROWNUM "RN"
	FROM "MEMBER"
	WHERE MEMBER_EMAIL LIKE '%' || #{searchText} || '%'
ORDER BY MEMBER_EMAIL DESC) E
WHERE E.RN BETWEEN 1 + ((#{cp}-1)*10)AND 10 + ((#{cp}-1)*10)
	</select>
	
	<select id="memberTelListU" resultType="Member">
SELECT E.*
FROM
	(SELECT 
		MEMBER_NO,
		MEMBER_NAME,
		MEMBER_EMAIL,
		MEMBER_PW,
		MEMBER_DEL_FL,
		MEMBER_DATE,
		MEMBER_ADDRESS,
		MEMBER_FL,
		MEMBER_POINT,
		MEMBER_TEL,
		MEMBER_ID,
		ROWNUM "RN"
	FROM "MEMBER"
	WHERE MEMBER_TEL LIKE '%' || #{searchText} || '%'
	ORDER BY MEMBER_TEL ASC) E
WHERE E.RN BETWEEN 1 + ((#{cp}-1)*10)AND 10 + ((#{cp}-1)*10)
	</select>
	<select id="memberTelListD" resultType="Member">
SELECT E.*
FROM
	(SELECT 
		MEMBER_NO,
		MEMBER_NAME,
		MEMBER_EMAIL,
		MEMBER_PW,
		MEMBER_DEL_FL,
		MEMBER_DATE,
		MEMBER_ADDRESS,
		MEMBER_FL,
		MEMBER_POINT,
		MEMBER_TEL,
		MEMBER_ID,
		ROWNUM "RN"
	FROM "MEMBER"
	WHERE MEMBER_TEL LIKE '%' || #{searchText} || '%'
ORDER BY MEMBER_TEL DESC) E
WHERE E.RN BETWEEN 1 + ((#{cp}-1)*10)AND 10 + ((#{cp}-1)*10)
	</select>
	
	<select id="allListU" resultType="Member">
SELECT E.*
FROM
	(SELECT 
		MEMBER_NO,
		MEMBER_NAME,
		MEMBER_EMAIL,
		MEMBER_PW,
		MEMBER_DEL_FL,
		MEMBER_DATE,
		MEMBER_ADDRESS,
		MEMBER_FL,
		MEMBER_POINT,
		MEMBER_TEL,
		MEMBER_ID,
		ROWNUM "RN"
	FROM "MEMBER"
	ORDER BY MEMBER_NO DESC) E
WHERE E.RN BETWEEN 1 + ((#{cp}-1)*10) AND 10 + ((#{cp}-1)*10)
	</select>
	<select id="allListD" resultType="Member">
SELECT E.*
FROM
	(SELECT 
		MEMBER_NO,
		MEMBER_NAME,
		MEMBER_EMAIL,
		MEMBER_PW,
		MEMBER_DEL_FL,
		MEMBER_DATE,
		MEMBER_ADDRESS,
		MEMBER_FL,
		MEMBER_POINT,
		MEMBER_TEL,
		MEMBER_ID,
		ROWNUM "RN"
	FROM "MEMBER"
	ORDER BY MEMBER_NO ASC) E
WHERE E.RN BETWEEN 1 + ((#{cp}-1)*10) AND 10 + ((#{cp}-1)*10)
	</select>
	
	
	<select id="deviceList" resultType="Device">
SELECT 
	A.DEVICE_NO,
	DEVICE_IMG,
	DEVICE_NAME,
	COLOR_RESULT "colorResult",
	DEVICE_DATE "deviceDate"
FROM 
	DEVICE A
JOIN
	(
	SELECT 
		DEVICE_NO,
		COUNT(DEVICE_NO) COLOR_RESULT,
		MAX(BUYING_DEVICE_UPLOAD_DATE) DEVICE_DATE
	FROM 
		BUYING_DEVICE
	WHERE 
		SOLD_FL = 'N'
	GROUP BY 
		DEVICE_NO
	) B ON (A.DEVICE_NO = B.DEVICE_NO)
ORDER BY
	DEVICE_DATE DESC
	</select>
	
	<select id="popUpData" resultType="Color">
	
	SELECT 
		COLOR_DEVICE_IMG,
		COLOR_NAME,  
		COUNT(BUYING_DEVICE_NO) colorResult
	FROM 
		COLOR
	JOIN 
	   (
	   	SELECT * FROM DEVICE WHERE DEVICE_NO=#{result}
	   ) USING (DEVICE_NO)
	LEFT JOIN 
			(
			SELECT * FROM BUYING_DEVICE WHERE SOLD_FL = 'N'
			) USING (COLOR_NO)
	GROUP BY 
		COLOR_DEVICE_IMG,COLOR_NAME, DEVICE_NAME
	</select>
	
	
	<select id="adminSearch" resultType="Device">
SELECT 
	A.DEVICE_NO,
	DEVICE_IMG,
	DEVICE_NAME,
	COLOR_RESULT "colorResult",
	DEVICE_DATE "deviceDate"
FROM 
	DEVICE A
JOIN
	(
	SELECT 
		DEVICE_NO,
		COUNT(DEVICE_NO) COLOR_RESULT,
		MAX(BUYING_DEVICE_UPLOAD_DATE) DEVICE_DATE
	FROM 
		BUYING_DEVICE
	WHERE 
		SOLD_FL = 'N'

	GROUP BY 
		DEVICE_NO
	) B ON (A.DEVICE_NO = B.DEVICE_NO)
WHERE 
	DEVICE_NAME LIKE '%' || #{search} || '%'
ORDER BY
	DEVICE_DATE DESC
	</select>

	
	
	
	
</mapper>
